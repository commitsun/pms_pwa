<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="pms_pwa_property_tab" name="PMS PWA Property Tab">
        <t t-esc="selected_property.name" />
        <span t-att-class="'o_pms_pwa_rounded_alert '+ ('d-none' if user_notification_qty==0 else ' ')">
            <t t-esc="user_notification_qty"/>
        </span>
    </template>

    <template id="user_property_notifications" name="PMS PWA User Property Notifications">
        <div class="o_pms_pwa_notification_dropdown dropdown"/>
        <div t-att-class="'o_pms_pwa_notification_dropdown dropdown '+ (notification_class if notification_class else ' ')">
            <a type="button" id="dropdownCloudButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img src="/pms_pwa/static/img/svg/cloud.svg" alt="notificaciones" class="img-responsive" loading="lazy"/>
            </a>
            <div class="dropdown-menu o_pms_pwa_notification_dropdown_menu" aria-labelledby="dropdownCloudButton">
                <t t-if="user_notification_ids">
                    <t t-foreach="user_notification_ids" t-as="notification">
                        <span>
                            <t t-esc="notification.message"/>
                            <a t-if="notification and notification.model_id and notification.model_id.model == 'pms.reservation'" href="#" class="o_pms_pwa_open_reservation_modal" t-att-data-id="notification.record_id"> Ver </a>
                            <i href="#" class="fa fa-trash o_pms_pwa_remove_alert ml-2" t-att-data-pms_property_id="notification.pms_pwa_property_id.id" t-att-data-id="notification.record_id"/>
                        </span>
                        <hr />
                    </t>
                    <span class="o_pms_pwa_remove_all_notifications"><a href="#" class="o_pms_pwa_remove_all_alert ml-2" t-att-data-user_id="user_id.id" ><i class="fa fa-trash "/> Eliminar todas</a></span>
                </t>
            </div>
        </div>
    </template>

    <template id="roomdoo_reduced_calendar_page" name="Small Calendar">
        <t t-call="website.layout">
            <t t-set="page_title" t-value="today.strftime('%d de %b')" />
            <t t-set="current_property" t-value="user_id.pms_pwa_property_id.id" />
            <t t-call="pms_pwa.o_pms_pwa_edit_modal" />
            <div class="o_pms_pwa_roomdoo_reservation_modal" />
            <div class="o_pms_pwa_roomdoo_alerts" />
            <div id="confirmChange" class="modal" tabindex="-1" role="dialog">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Confirmar cambio</h5>
                            <button type="button" class="close close_confirmChange" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">X</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>Deseas realizar el movimiento</p>
                        </div>
                        <div class="modal-footer">
                            <input type="hidden" name="modal_date" value=""></input>
                            <input type="hidden" name="modal_reservation" value=""></input>
                            <input type="hidden" name="modal_room" value=""></input>
                            <input type="hidden" name="modal_property_id" t-attf-value="{{current_property}}"></input>
                            <button type="button" class="btn btn-message send_ConfirmChanges">Confirmar cambio</button>
                            <button type="button" class="btn btn-secondary close_confirmChange" data-dismiss="modal">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="changesDaysValues" class="modal" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-xl" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Modificaciones de reglas</h5>
                            <button type="button" class="close close_changesDaysValues" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">X</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form>
                                <div class="row">
                                    <div class="col-5">
                                        <div class="form-group row">
                                            <label for="desde" class="col-sm-2 col-form-label">Desde</label>
                                            <div class="col-sm-10">

                                                <input id="start_date" type="text" class="modaldate form-control" name="modal_start_date" placeholder="Desde" value=""/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <label for="hasta" class="col-sm-2 col-form-label">Hasta</label>
                                            <div class="col-sm-10">

                                                <input id="end_date" type="text" class="modaldate form-control" name="modal_end_date" placeholder="Hasta" value=""/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-7">
                                        <div class="form-group row">
                                            <label for="pms_property_id" class="col-sm-2 col-form-label">Hotel</label>
                                            <div class="col-sm-10">
                                                <t t-foreach="user_id.pms_pwa_property_ids" t-as="selected_property">
                                                    <t t-if="selected_property.id == pms_property_id">
                                                        <input type="text" disabled="disabled" class="form-control" name="modal_pms_property_name" t-attf-value="{{ selected_property.name }}" placeholder="Hotel" />
                                                        <input type="hidden" class="form-control" name="modal_pms_property_id" t-attf-value="{{ selected_property.id }}" />
                                                    </t>
                                                </t>
                                            </div>
                                        </div>
                                        <div class="form-group row modal_availability_plan_ids">
                                            <label for="modal_availability_plan_ids" class="col-sm-2 col-form-label">Disponibilidad</label>
                                            <div class="col-sm-10">
                                                <select id="select_availability_plan_id" name="modal_availability_plan_ids" class="selectpicker" multiple="multiple" data-mdb-clear-button="true" data-live-search="true">
                                                    <t t-foreach="allowed_availability_plans" t-as="availability_plan">
                                                        <option t-att-value="availability_plan['id']" t-att-selected="select_availability_plan_id==availability_plan['id']">
                                                            <t t-esc="availability_plan['name']" />
                                                        </option>
                                                    </t>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-5">
                                        <div class="form-group row modal_pricelist_id">
                                            <label for="modal_pricelist_id" class="col-sm-2 col-form-label">Tarifa</label>
                                            <div class="col-sm-10">
                                                <select id="modal_pricelist_id" name="modal_pricelist_id" class="selectpicker" multiple="multiple" data-mdb-clear-button="true" data-live-search="true">
                                                    <t t-foreach="allowed_pricelists" t-as="pricelist">
                                                        <option t-att-value="pricelist['id']" t-att-selected="pricelist['id']==select_pricelist_id">
                                                            <t t-esc="pricelist['name']" />
                                                        </option>
                                                    </t>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-7">
                                        <div class="form-group row modal_room_type">
                                            <label for="room_type" class="col-sm-2 col-form-label">Tipo de habitación</label>
                                            <div class="col-sm-10">
                                                <select id="room_type_model" name="modal_room_type" class="selectpicker" data-mdb-clear-button="true" data-live-search="true">
                                                    <t t-foreach="rooms_list" t-as="r_type">
                                                        <option t-att-value="r_type['id']"><t t-esc="r_type['name']"/></option>
                                                    </t>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-4">
                                    <div class="col-12">
                                        <h3>Días</h3>
                                    </div>
                                    <div class="col-12">
                                        <table class="table table-condensed" id="multi_days_values">
                                            <thead>
                                                <tr>
                                                    <td class="o_pms_pwa_theme_color">Todos</td>
                                                    <td class="o_pms_pwa_theme_color">Lunes</td>
                                                    <td class="o_pms_pwa_theme_color">Martes</td>
                                                    <td class="o_pms_pwa_theme_color">Miércoles</td>
                                                    <td class="o_pms_pwa_theme_color">Jueves</td>
                                                    <td class="o_pms_pwa_theme_color">Viernes</td>
                                                    <td class="o_pms_pwa_theme_color">Sábado</td>
                                                    <td class="o_pms_pwa_theme_color">Domingo</td>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input name="apply_on_all_week" data-edit="true" t-attf-tabindex="1" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input data-edit="true" t-attf-tabindex="2" name="apply_on_monday" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input data-edit="true" t-attf-tabindex="3" name="apply_on_tuesday" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input data-edit="true" t-attf-tabindex="4" name="apply_on_wednesday" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input data-edit="true" t-attf-tabindex="5" name="apply_on_thursday" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input data-edit="true" t-attf-tabindex="6" name="apply_on_friday" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input data-edit="true" t-attf-tabindex="7" name="apply_on_saturday" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                    <td>
                                                        <p style="text-align:center">
                                                            <label class="switch">
                                                                <input data-edit="true" t-attf-tabindex="8" name="apply_on_sunday" type="checkbox" />
                                                                <span class="slider round"></span>
                                                            </label>
                                                        </p>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="row roomdoo_rules">
                                    <div class="col-12">
                                        <h3>Reglas</h3>
                                        <hr />
                                    </div>
                                    <div class="col-6">
                                        <div class="form-group row">
                                            <div class="col-2 show_price" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_price_check" class="hidde_show_price" name="show_price" type="checkbox" />
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="price" class="col-sm-6 col-form-label">Precio</label>
                                            <div class="col-sm-2">
                                                <input type="text" class="form-control hidde_price hidde_modal" name="modal_price" placeholder="Price"/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-2 show_cupo" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_cupo_check" class="hidde_show_cupo" name="show_cupo" type="checkbox" />
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="cupo" class="col-sm-6 col-form-label">Cupo</label>
                                            <div class="col-sm-2">
                                                <input type="text" class="form-control hidde_cupo hidde_modal" name="modal_cupo" placeholder="Cupo"/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-2" style="align-self: end;">
                                                <label class="switch show_estmin" >
                                                    <input data-edit="false" id="show_cupo_check" class="hidde_show_estmin" name="show_estmin" type="checkbox" />
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="estmin" class="col-sm-6 col-form-label">Estancia Mínima</label>
                                            <div class="col-sm-2">
                                                <input type="text" class="form-control hidde_estmin hidde_modal" name="modal_estmin" placeholder="Est. Mín"/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-2 show_closed" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_closed_check" class="hidde_show_closed" name="show_closed" type="checkbox" />
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="closed" class="col-sm-6 col-form-label">Cerrado</label>
                                            <div class="col-sm-2">
                                                <label class="switch hidde_closed hidde_modal">
                                                    <input data-edit="false" name="modal_closed" type="checkbox"/>
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-2 show_max_dispo" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_max_dispo_check" class="hidde_show_max_dispo" name="show_max_dispo" type="checkbox" />
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="max_dispo" class="col-sm-6 col-form-label">Máxima Disponibilidad</label>
                                            <div class="col-sm-2">
                                                <input type="text" class="form-control hidde_max_dispo hidde_modal" id="max_dispo" name="modal_max_dispo" placeholder="Máx. Disp."/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">

                                        <div class="form-group row">
                                            <div class="col-2 show_max_stay" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_max_stay_check" class="hidde_show_max_stay" name="show_max_stay" type="checkbox" />
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="max_stay" class="col-sm-6 col-form-label">Estancia Máxima</label>
                                            <div class="col-sm-2">
                                                <input type="text" class="form-control hidde_max_stay hidde_modal" id="max_stay" name="modal_max_stay" placeholder="Est. Máx"/>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-2 show_max_stay_sa" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_max_stay_sa_check" class="hidde_show_max_stay_sa" name="show_max_stay_sa" type="checkbox" />
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="max_stay" class="col-sm-6 col-form-label">Est. Máxima Salidas</label>
                                            <div class="col-sm-2">
                                                <input type="text" class="form-control hidde_max_stay_sa hidde_modal" id="max_stay_sa" name="modal_max_stay_sa" placeholder="Est. Máx Sa." />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-2 show_max_stay_ll" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_max_stay_ll_check" class="hidde_show_max_stay_ll" name="show_max_stay_ll" type="checkbox"/>
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="max_stay" class="col-sm-6 col-form-label">Est. Máxima Llegadas</label>
                                            <div class="col-sm-2">
                                                <input type="text" class="form-control hidde_max_stay_ll hidde_modal" name="modal_max_stay_ll" placeholder="Est. Máx Ll." />
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-2 show_closed_arrival" style="align-self: end;">
                                                <label class="switch">
                                                    <input data-edit="false" id="show_closed_arrival_check" class="hidde_show_closed_arrival" name="show_closed_arrival" type="checkbox"/>
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                            <label for="closed_arrival" class="col-sm-6 col-form-label">Cerrar Llegadas</label>
                                            <div class="col-sm-2">
                                                <label class="switch hidde_closed_arrival hidde_modal">
                                                    <input data-edit="false" name="modal_closed_arrival" type="checkbox"/>
                                                    <span class="slider round"></span>
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <input type="hidden" name="modal_date" value=""></input>
                            <input type="hidden" name="modal_reservation" value=""></input>
                            <input type="hidden" name="modal_room" value=""></input>
                            <a type="button" class="btn btn-message send_changesDaysValues">Confirmar cambio</a>
                            <button type="button" class="btn btn-secondary close_changesDaysValues" data-dismiss="modal">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="oe_structure o_pms_pwa_structure mt-4">

                <section class="container-fluid o_pms_pwa_roomdoo">
                    <!-- Calendar -->

                    <ul class="nav nav-tabs" id="propertyTab" role="tablist">
                        <t t-foreach="user_id.pms_pwa_property_ids" t-as="selected_property">
                            <t t-if="user_id and selected_property">
                                <t t-set="user_notification_ids" t-value="user_id.user_notification_ids.filtered(lambda x: x.pms_pwa_property_id.id == selected_property.id and x.is_read == False)"/>
                            </t>
                            <li class="nav-item">
                                <t t-if="selected_property.id == pms_property_id">
                                    <a class="nav-link active property-change" t-attf-id="property-tab-{{ selected_property.id }}" t-attf-data-sl-property="{{ selected_property.id }}" data-toggle="tab" role="tab" aria-controls="home" aria-selected="true">
                                        <t t-call="pms_pwa.pms_pwa_property_tab">
                                            <t t-set="user_notification_qty" t-value="len(user_notification_ids) or 0"/>
                                            <t t-set="selected_property" t-value="selected_property"/>
                                        </t>
                                    </a>
                                </t>
                                <t t-else="">
                                    <a class="nav-link property-change" t-attf-id="property-tab-{{ selected_property.id }}" t-attf-data-sl-property="{{ selected_property.id }}" data-toggle="tab" role="tab" aria-controls="home" aria-selected="false">
                                        <t t-call="pms_pwa.pms_pwa_property_tab">
                                            <t t-set="user_notification_qty" t-value="len(user_notification_ids) or 0"/>
                                            <t t-set="selected_property" t-value="selected_property"/>
                                        </t>
                                    </a>
                                </t>
                            </li>
                        </t>
                    </ul>

                    <div class="o_pms_pwa_reduced_calendar o_pms_pwa_full_shadow bg-white p-5">
                        <div id="o_pms_pwa_update_calendar" class="o_pms_pwa_update_calendar">
                            <button id="update_calendar" name="update_calendar" class="btn btn-radius btn-pms_pwa" style="display:none;">
                                Actualizar calendario
                            </button>
                        </div>
                        <div id="notifications_container" class="notifications_container">
                            <t t-call="pms_pwa.user_property_notifications">
                                <t t-set="user_notification_ids" t-value="user_id.user_notification_ids.filtered(lambda x: x.pms_pwa_property_id.id == pms_property_id and x.is_read == False)"/>
                                <t t-set="notification_class" t-value="'notifications_property_'+ str(pms_property_id)"/>
                            </t>
                        </div>
                        <div id="buttom_save">
                            <button id="save" name="save" class="btn btn-radius btn-pms_pwa w-100 d-none">
                                Guardar
                            </button>
                        </div>
                        <div class="row mb-2">
                            <div class="col-12 mb-2 ">
                                <form t-attf-action="/reservation/list" method="post" t-att-class="_classes">

                                    <div class="row m-0 p-0 align-items-center">

                                        <div class="col-10 col-md-8 col-lg-7">
                                            <input type="text" name="search" class="form-control o_pmw_pwa_search_input" placeholder="Buscar" title="Buscar..." />
                                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                                            <input type="hidden" name="pms_property_id" t-att-value="pms_property_id" />
                                        </div>

                                        <div class="col-2 col-md-4 col-lg-5 text-right text-xl-left pr-0">
                                            <span class="dropdown">
                                                <a class="btn o_pms_pwa_float_right" href="#" data-toggle="modal" data-target="#o_pms_pwa_filters_modal" rel="nofollow">
                                                    <span class="d-none d-lg-flex align-self-center">
                                                        FILTROS
                                                        <i class="fa fa-angle-left" />
                                                    </span>
                                                    <i class="fa fa-filter d-lg-none"></i>
                                                </a>
                                            </span>
                                            <a t-attf-href="/reservation/list?ready_for_checkin=true&amp;pms_property_id={{ pms_property_id }}" label="Checkins" class="btn o_pms_pwa_button_filter align-self-center">
                                                <img src="/pms_pwa/static/img/svg/icon_arrival.svg" width="18px" alt="Checkins" class="img-responsive" />
                                            </a>
                                            <a t-attf-href="/reservation/list?in_house=true&amp;pms_property_id={{ pms_property_id }}" label="Dentro" class="btn o_pms_pwa_button_filter">
                                                <img src="/pms_pwa/static/img/svg/icon_house.svg" width="18px" alt="Dentro" class="img-responsive" />
                                            </a>
                                            <a t-attf-href="/reservation/list?ready_for_checkout=true&amp;pms_property_id={{ pms_property_id }}" label="Checkouts" class="btn o_pms_pwa_button_filter">
                                                <img src="/pms_pwa/static/img/svg/icon_exit.svg" width="18px" alt="Checkouts" class="img-responsive" />
                                            </a>
                                        </div>
                                        <t t-call="pms_pwa.roomdoo_filters_modal">
                                            <t t-set="post" t-value="post" />
                                            <t t-set="search" t-value="search" />
                                        </t>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <form method="post" action="">
                            <div class="row m-0 p-0 mb-2" id="o_pms_pwa_calendar_filters">
                                <!-- select pricelist -->
                                <div class="col-md-4 col-lg-4 col-xl-4 pr-0">
                                    Tarifa:
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                                    <input type="hidden" name="selected_date" t-att-value="selected_date.strftime('%d/%m/%Y')" />
                                    <input type="hidden" name="selected_property" t-att-value="pms_property_id" />
                                    <select id="pricelist_select" name="pricelist" data-select="allowed_pricelists" t-att-data-property="pms_property_id" class="form-control o_website_form_input o_input select_calendar">
                                        <t t-foreach="allowed_pricelists" t-as="pricelist">
                                            <option t-att-value="pricelist['id']" t-att-selected="select_pricelist_id==pricelist['id']">
                                                <t t-esc="pricelist['name']" />
                                            </option>
                                        </t>
                                    </select>
                                </div>
                                <div class="col-md-4 col-lg-4 col-xl-4 pr-0">
                                    Plan de disponibilidad:
                                    <select id="select_availability_plan_id" name="availability_plan" data-select="allowed_availability_plans" t-att-data-property="pms_property_id" class="form-control o_website_form_input o_input select_calendar">
                                        <t t-foreach="allowed_availability_plans" t-as="availability_plan">
                                            <option t-att-value="availability_plan['id']" t-att-selected="select_availability_plan_id==availability_plan['id']">
                                                <t t-esc="availability_plan['name']" />
                                            </option>
                                        </t>
                                    </select>
                                </div>
                                <div class="col-md-4 col-lg-4 col-xl-4 pr-0">
                                    <span class="d-block">Fecha:</span>
                                    <div class="o_pms_pwa_month_select form-control px-0">
                                        <a t-attf-href="?previous_month={{date_start.strftime('%d/%m/%Y')}}&amp;pricelist={{select_pricelist_id}}&amp;selected_property={{ pms_property_id }}" class="mx-2 o_pms_pwa_calendar_arrow">
                                            <i class="fa fa-angle-left" />
                                        </a>
                                        <input type="hidden" name="calendar_selected_date" t-value="date_start" />
                                        <input type="hidden" name="selected_property" t-att-value="pms_property_id" />
                                        <button type="button" class="btn btn-calendar-roomdoo o_pms_pwa_daterangepicker_calendar" data-dismiss="modal">
                                            <t t-esc="date_start" t-options='{"widget": "date", "format": "MMMM dd"}' />
                                        </button>

                                        <a t-attf-href="?next_month={{date_start.strftime('%d/%m/%Y')}}&amp;pricelist={{select_pricelist_id}}&amp;selected_property={{ pms_property_id }}" class="mx-2 o_pms_pwa_calendar_arrow">
                                            <i class="fa fa-angle-right" />
                                        </a>
                                        <a t-attf-href="?selected_date={{(today - datetime.timedelta(days=1)).strftime('%d/%m/%Y')}}&amp;pricelist={{select_pricelist_id}}&amp;selected_property={{ pms_property_id }}" class="btn btn-pms_pwa" style="background:white;width:100px;" t-if="(selected_date).strftime('%d-%m-%Y') != (today - datetime.timedelta(days=1)).strftime('%d-%m-%Y')">Hoy</a>
                                    </div>

                                </div>

                            </div>
                        </form>
                        <hr />
                        <div class="table-responsive" id="o_pms_pwa_table_reduced">
                            <input type="hidden" name="date_list" t-attf-value="{{ date_list }}" />
                            <table id="reduced_calendar_table" class="table o_pms_pwa_reduced_reservation_list_table" data-show-columns="true">
                                <thead>
                                    <tr>
                                        <th class="align-self-end o_pms_pwa_table_week o_pms_pwa_table_first_header_td" style="z-index: none !important; background-color: white !important;"></th>
                                        <t t-foreach="date_list" t-as="day">
                                            <th t-att-class="'text-center o_pms_pwa_table_week '
                                                    + ('o_pms_pwa_today ' if today.strftime('%Y-%m-%d')==day.strftime('%Y-%m-%d') else ' ')
                                                    + ('o_pms_pwa_weekend ' if int(day.strftime('%w'))==5 else ' ')
                                                    + ('o_pms_pwa_weekend ' if int(day.strftime('%w'))==6 else ' ')
                                                    " t-att-data-value="x" style="padding-bottom:0;">
                                                <t t-set="property_total_day_reservations" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['reservations_count']"></t>
                                                <t t-set="property_total_out_service" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['outs_count']"></t>
                                                <t t-set="availability_day" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['num_avail']"></t>
                                                <t t-set="percent_occupied" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['percent_occupied']"></t>
                                                <span class="header_date">
                                                    <t t-esc="day" t-options='{"widget": "date", "format": "EEE dd, MMM"}' />
                                                </span>
                                                <div class="row percentage-container">
                                                    <span t-if="percent_occupied == 100" style="width:100%">
                                                        <div class="percent_occupied_100" />
                                                    </span>
                                                    <span t-if="percent_occupied &gt; 74 and percent_occupied &lt; 100" style="width:100%">
                                                        <div class="percent_occupied_99" />
                                                    </span>
                                                    <span t-if="percent_occupied &gt; 49 and percent_occupied &lt; 75" style="width:100%">
                                                        <div class="percent_occupied_75" />
                                                    </span>
                                                    <span t-if="percent_occupied &gt; 24 and percent_occupied &lt; 50" style="width:100%">
                                                        <div class="percent_occupied_50" />
                                                    </span>
                                                    <span t-if="percent_occupied &gt; 0 and percent_occupied &lt; 25" style="width:100%">
                                                        <div class="percent_occupied_25" />
                                                    </span>
                                                    <span t-if="percent_occupied == 0" style="width:100%">
                                                        <div class="percent_occupied_0" />
                                                    </span>
                                                </div>
                                            </th>
                                        </t>
                                    </tr>

                                </thead>
                                <tbody>
                                    <tr class="o_pms_pwa_open_reduced_calendar" t-attf-data-id="{{ pms_property_id }}" data-toggle="collapse" t-att-data-target="'#collapse_accordion_'+str(pms_property_id)" aria-expanded="false">
                                        <td class="o_pms_pwa_table_first_header_td">
                                            <p class="o_pms_pwa_room_name">
                                                <i class="fa fa-angle-down"></i>
                                                <t t-foreach="user_id.pms_pwa_property_ids" t-as="selected_property">
                                                    <t t-if="selected_property.id == pms_property_id">
                                                        <t t-esc="selected_property.name" />
                                                    </t>
                                                </t>
                                            </p>
                                        </td>
                                        <t t-foreach="date_list" t-as="day">

                                            <t t-set="availability_room" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['num_avail']"></t>
                                            <t t-set="rooms_occupied_reservations" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['reservations_count']"></t>
                                            <t t-set="rooms_occupied_out_service" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['outs_count']"></t>
                                            <t t-set="percent_occupied" t-value="general_headers[day.strftime('%Y-%m-%d')]['property_header']['percent_occupied']"></t>
                                            <td t-att-class="'o_calendar_header_property '
                                                + ('o_pms_pwa_dispo_0' if availability_room==0 else ' ')
                                                + ('o_pms_pwa_dispo_1' if availability_room==1 else ' ')
                                            " style="padding: 0 !important;">
                                                <div class="float-center o_pms_pwa_title" style="text-align: center !important; font-weight: bold !important; margin-bottom: 0px !important;">
                                                    <t t-esc="percent_occupied" t-options="{'widget': 'float', 'precision': 0}" />
                                                    %
                                                    <div t-if="notifications_info" class="dropdown" style="float:right;">
                                                        <a class="dropdown-toggle" t-attf-id="dropdownInfo{{day}}" type="button" data-toggle="dropdown">
                                                            <i class="fa fa-info"></i>
                                                        </a>
                                                        <div class="dropdown-menu" t-attf-aria-labelledby="dropdownInfo{{day}}">
                                                            <t t-foreach="notifications_info" t-as="notifi">
                                                                <a class="dropdown-item" href="#"><t t-esc="notifi"/></a>
                                                            </t>
                                                        </div>
                                                    </div>
                                                </div>
                                                <p class="o_pms_pwa_title" style="text-align: center !important; margin-bottom: 0px !important;">
                                                    <t t-esc="availability_room" />
                                                    Libres
                                                </p>
                                                <div class="circles-container text-center row m-0 mt-2 p-0 " style="">
                                                    <div class="col-4 m-0 pt-1 p-0 row align-items-center justify-content-center" title="Reservas" style="padding-bottom: 2px !important; padding-top: 0 !important;">
                                                        <div t-if="rooms_occupied_reservations > 0" class="circle" style="-0.6rem !important;">
                                                            <span>
                                                                <t t-esc="rooms_occupied_reservations" />
                                                            </span>
                                                        </div>
                                                        <div t-else="" style="min-height: 25px;"></div>
                                                    </div>
                                                    <div class="col-4 m-0 pt-1 p-0 row align-items-center justify-content-center" title="Fuera de servicio" style="padding-bottom: 2px !important; padding-top: 0 !important;">
                                                        <div t-if="rooms_occupied_out_service > 0" class="circle" style="-0.6rem !important;">
                                                            <span>
                                                                <t t-esc="rooms_occupied_out_service" />
                                                            </span>
                                                        </div>
                                                        <div t-else="" style="min-height: 25px;"></div>
                                                    </div>
                                                    <div class="col-4 m-0 pt-1 p-0 row align-items-center justify-content-center" title="Warning" style="padding-bottom: 2px !important; padding-top: 0 !important;">
                                                        <div t-if="notifications_warning" style="-0.6rem !important;">
                                                            <div class="dropdown">
                                                                <a class="dropdown-toggle" t-attf-id="dropdownMenu{{day}}" type="button" data-toggle="dropdown">
                                                                  <img src="/pms_pwa/static/img/warning.png" alt="warning" width="15" />
                                                                </a>
                                                                <div class="dropdown-menu" t-attf-aria-labelledby="dropdownMenu{{day}}">
                                                                    <t t-foreach="notifications_warning" t-as="notifi">
                                                                        <a class="dropdown-item" href="#"><t t-esc="notifi"/></a>
                                                                    </t>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div t-else="" style="min-height: 25px;"></div>
                                                    </div>
                                                </div>
                                            </td>
                                        </t>
                                    </tr>
                                    <tr>
                                        <td t-att-colspan="len(date_list)+1" class="o_pms_pwa_hiddenRow collapse" t-att-id="'collapse_accordion_'+str(pms_property_id)" t-attf-aria-labelledby="{{ pms_property_id }}" style="width:100% !important"></td>
                                    </tr>
                                    <tr class="o_pms_pwa_open_reduced_calendar" t-attf-data-id="{{ pms_property_id }}" data-toggle="collapse" t-att-data-target="'#collapse_accordion_'+str(pms_property_id)" aria-expanded="false">
                                        <td t-att-colspan="len(date_list)+1" t-attf-aria-labelledby="{{ pms_property_id }}" style="width: 100% !important;height: 5px !important;border-radius: 5rem;background-color: #eaeaea;font-size: 14px;padding: 0;">
                                            <span style="left: 40%;position: sticky;cursor:pointer;">
                                                <i class="fa fa-angle-down"></i> <strong>Reservas</strong>  <i class="fa fa-angle-down"></i>
                                            </span>
                                        </td>
                                    </tr>
                                    <t t-foreach="rooms_list" t-as="room">
                                        <tr class="o_pms_pwa_open_calendar_config" t-attf-data-id="{{ room['id'] }}" data-toggle="collapse" t-attf-data-target="#collapse_rooms_type_{{ room['id'] }}" aria-expanded="false">
                                            <td class="o_pms_pwa_table_first_header_td">
                                                <p class="o_pms_pwa_room_name">
                                                    <i class="fa fa-angle-down"></i>
                                                    <t t-esc="room['default_code']" />
                                                    <span class="o_pms_pwa_title" style="text-align: center !important;">
                                                        (
                                                        <t t-esc="room['total_rooms']" />
                                                        )
                                                    </span>
                                                </p>
                                            </td>
                                            <t t-foreach="date_list" t-as="day">

                                                <t t-set="sale_avail" t-value="rule_headers[day.strftime('%Y-%m-%d')][room['id']]['plan_avail']"></t>
                                                <t t-set="availability_room" t-value="general_headers[day.strftime('%Y-%m-%d')][room['id']]['num_avail']" />
                                                <t t-set="rooms_occupied_reservations" t-value="general_headers[day.strftime('%Y-%m-%d')][room['id']]['reservations_count']"></t>
                                                <t t-set="rooms_occupied_out_service" t-value="general_headers[day.strftime('%Y-%m-%d')][room['id']]['outs_count']"></t>

                                                <t t-set="availability_room_percent" t-value="general_headers[day.strftime('%Y-%m-%d')][room['id']]['avail_percent']" />
                                                <t t-set="rooms_occupied_reservations_percent" t-value="general_headers[day.strftime('%Y-%m-%d')][room['id']]['reservations_percent']"></t>
                                                <t t-set="rooms_occupied_out_service_percent" t-value="general_headers[day.strftime('%Y-%m-%d')][room['id']]['outs_percent']"></t>
                                                <td t-att-class="'o_config_pms_pwa_table_cell '
                                                    + ('o_pms_pwa_dispo_0' if availability_room==0 else ' ')
                                                    + ('o_pms_pwa_dispo_1' if availability_room==1 else ' ')
                                                " style="padding: 0 !important;">
                                                    <div class="progress">
                                                        <div
                                                            class="progress-bar progress-bar-success"
                                                            role="progressbar"
                                                            t-attf-style="width:{{rooms_occupied_reservations_percent}}%">
                                                            <t t-esc="rooms_occupied_reservations" />
                                                        </div>
                                                        <div class="progress-bar progress-bar-warning" role="progressbar" t-attf-style="width:{{rooms_occupied_out_service_percent}}%">
                                                            <t t-esc="rooms_occupied_out_service" />
                                                        </div>
                                                        <div class="progress-bar progress-bar-danger" role="progressbar" t-attf-style="width:{{availability_room_percent}}%">
                                                            <t t-esc="availability_room" />
                                                        </div>
                                                    </div>
                                                    <p class="calendar_config_input" style="text-align:center; padding-top:0 !important; margin-bottom:0 !important;">
                                                        <input t-attf-data-room="{{ room['id'] }}" t-attf-data-pricelist="{{ select_pricelist_id }}" t-attf-data-pms_property_id="{{ pms_property_id }}" t-attf-data-availability_plan="{{ select_availability_plan_id }}" t-attf-data-date="{{ day }}" data-edit="false" t-attf-tabindex="{{ select_pricelist_id }}1" style="text-align:center; width:35%; border:0; margin-top:2px; color: $black !important; font-weight: bold !important;" type="text" t-att-value="price_headers[day.strftime('%Y-%m-%d')][room['id']]" name="price" />€
                                                    </p>

                                                    <div class="circles-container text-center row m-0 mt-2 p-0 " style="padding-top:0px !important; margin-top:0px !important">
                                                        <div class="col-3 m-0 pt-1 p-0 row align-items-center justify-content-center o_pms_pwa_edit_circle" title="editar">
                                                            <div class="circle edit_hide">
                                                                <span class="open_changeValues" t-attf-data-pms_property_id="{{ pms_property_id }}" t-attf-data-pricelist="{{ select_pricelist_id }}" t-attf-data-availability_plan="{{ select_availability_plan_id }}" t-attf-data-date="{{ day }}" t-attf-data-room_type="{{ room['id'] }}">
                                                                    <i class="fa fa-edit"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="col-6 m-0 pt-1 p-0 row align-items-center justify-content-center" title="A la venta">
                                                            <!-- <p class="o_pms_pwa_title" style="text-align: center !important; margin-bottom: 0px !important;font-size:14px">
                                                                <t t-esc="availability_room" />
                                                                Libres
                                                            </p> -->
                                                        </div>
                                                        <div class="col-3 m-0 pt-1 p-0 row align-items-center justify-content-center" title="A la venta">
                                                            <t t-if="sale_avail != -1">
                                                                <div t-if="sale_avail > 0" class="circle">
                                                                    <span>
                                                                        <t t-esc="sale_avail" />
                                                                    </span>
                                                                </div>
                                                                <div t-if="sale_avail == 0" class="circle" style="background-color: rgb(252, 123, 147); color: white;">
                                                                    <span>
                                                                        <t t-esc="sale_avail" />
                                                                    </span>
                                                                </div>
                                                            </t>
                                                            <t t-else="">
                                                                <t t-set="sale_avail" t-value="0"></t>
                                                                <div t-if="sale_avail > 0" class="circle">
                                                                    <span>
                                                                        <t t-esc="sale_avail" />
                                                                    </span>
                                                                </div>
                                                                <div t-if="sale_avail == 0" class="circle" style="background-color: rgb(252, 123, 147); color: white;">
                                                                    <span>
                                                                        <t t-esc="sale_avail" />
                                                                    </span>
                                                                </div>
                                                            </t>

                                                        </div>
                                                    </div>
                                                </td>
                                            </t>
                                        </tr>
                                        <tr class="collapse o_pms_pwa_open_calendar_config" t-attf-id="collapse_rooms_type_{{ room['id'] }}" t-attf-aria-labelledby="{{ room['id'] }}">
                                            <td t-att-colspan="len(date_list)+1">
                                                <table class="table subtable" id="calendar_conf_table_line" style="margin-bottom: 0;  padding-top: 0;">
                                                    <tr t-attf-data-id="len(date_list)+1">
                                                        <td class="o_pms_pwa_show_table" style=" padding-top: 0; padding-left: 0;">
                                                            <p style="text-align:end; height:28px; ">
                                                                <span style="min-width:80px !important;">Cupo</span>
                                                            </p>
                                                            <p style="text-align:end; height:28px;">
                                                                <span style="min-width:80px !important;">Est. Mín</span>
                                                            </p>
                                                        </td>

                                                        <t t-foreach="date_list" t-as="room_day">
                                                            <td t-att-class="'o_config_pms_pwa_table_cell '
                                                                    " t-attf-data="{{ room_day }}" style="padding-top: 0;">
                                                                <p class="calendar_config_input" style="text-align:center;margin-right: 0.25rem;">
                                                                    <input
                                                                          t-attf-data-room="{{ room['id'] }}"
                                                                          t-attf-data-pricelist="{{ select_pricelist_id }}"
                                                                          t-attf-data-availability_plan="{{ select_availability_plan_id }}"
                                                                          t-attf-data-date="{{ room_day.strftime('%Y-%m-%d') }}"
                                                                          t-attf-data-pms_property_id="{{ pms_property_id }}"
                                                                          data-edit="false"
                                                                          t-attf-tabindex="{{ select_pricelist_id }}2{{room_day.strftime('%Y-%m-%d')}}"
                                                                          style="width:50px;"
                                                                          type="text"
                                                                          t-attf-value="{{ rule_headers[room_day.strftime('%Y-%m-%d')][room['id']]['quota'] }}"
                                                                          name="cupo"
                                                                    />
                                                                </p>
                                                                <p class="calendar_config_input" style="text-align:center;margin-right: 0.25rem;">
                                                                    <input
                                                                          t-attf-data-room="{{ room['id'] }}"
                                                                          t-attf-data-pricelist="{{ select_pricelist_id }}"
                                                                          t-attf-data-availability_plan="{{ select_availability_plan_id }}"
                                                                          t-attf-data-date="{{ room_day.strftime('%Y-%m-%d') }}"
                                                                          t-attf-data-pms_property_id="{{ pms_property_id }}"
                                                                          data-edit="false"
                                                                          t-attf-tabindex="{{ select_pricelist_id }}2{{room_day.strftime('%Y-%m-%d')}}"
                                                                          style="width:50px;"
                                                                          type="text"
                                                                          t-attf-value="{{ rule_headers[room_day.strftime('%Y-%m-%d')][room['id']]['min_stay'] }}"
                                                                          name="min_stay"
                                                                    />
                                                                </p>
                                                                <p class="calendar_config_input" style="text-align:center;">
                                                                    <label class="switch">
                                                                        <t t-if="rule_headers[room_day.strftime('%Y-%m-%d')][room['id']]['closed']">
                                                                            <input
                                                                                t-attf-data-room="{{ room['id'] }}"
                                                                                t-attf-data-pricelist="{{ select_pricelist_id }}"
                                                                                t-attf-data-availability_plan="{{ select_availability_plan_id }}"
                                                                                t-attf-data-date="{{ room_day.strftime('%Y-%m-%d') }}"
                                                                                t-attf-data-pms_property_id="{{ pms_property_id }}"
                                                                                data-edit="true"
                                                                                name="closed"
                                                                                type="checkbox"
                                                                                checked="true"/>
                                                                        </t>
                                                                        <t t-else="">
                                                                            <input
                                                                                t-attf-data-room="{{ room['id'] }}"
                                                                                t-attf-data-pricelist="{{ select_pricelist_id }}"
                                                                                t-attf-data-availability_plan="{{ select_availability_plan_id }}"
                                                                                t-attf-data-date="{{ room_day.strftime('%Y-%m-%d') }}"
                                                                                t-attf-data-pms_property_id="{{ pms_property_id }}"
                                                                                data-edit="false"
                                                                                name="closed"
                                                                                type="checkbox"/>
                                                                        </t>
                                                                        <span class="slider round"></span>
                                                                    </label>
                                                                </p>
                                                            </td>
                                                        </t>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </section>
            </div>
        </t>
    </template>
</odoo>
