<?xml version="1.0" encoding="utf-8"?>
<templates id="pms_pwa" xml:space="preserve">
    <t t-name="pms_pwa.roomdoo_reservation_modal">
        <!-- Modal -->
        <t t-if="reservation">
            <div class="modal o_pms_pwa_right fade o_pms_pwa_reservation_modal" tabindex="-1" role="dialog" aria-labelledby="o_pms_pwa_reservation_modal" id="o_pms_pwa_reservation_modal" t-att-data-id="reservation.id">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header o_pms_pwa_modal_header">
                            <div class="col-12">
                                <div class="row o_pms_pwa_modal_header_pad">
                                    <h4 class="col-6 modal-title">
                                        <t t-esc="texts.reservation_text || _t('Reserva')" />
                                        <span t-esc="reservation.name" />
                                    </h4>
                                    <a t-att-href="'/reservation/' + reservation.id" class="col-4 btn o_pms_pwa_btn_border float-right o_pms_pwa_preloader" t-att-data-id="reservation.id">
                                        <t t-esc="texts.info_text || _t('Más información')" />
                                    </a>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span class="fa fa-times" />
                                    </button>
                                </div>
                            </div>
                            <div class="col-12 mt-1">
                                <img t-if="reservation.agency_id and reservation.agency_id.id" t-att-src="'/web/image/res.partner/'+reservation.agency_id.id+'/image_128'" width="80" t-att-title="reservation.agency_id.name" t-att-alt="reservation.agency_id.name" />
                                <span t-else="">
                                    <span t-if="reservation.channel_type_id" t-esc="reservation.channel_type_id.name" />
                                </span>
                            </div>
                        </div>
                        <div class="modal-body o_pms_pwa_modal_body">
                            <div class="o_pms_pwa_shadow">
                                <div class="row">
                                    <div class="col-3 align-self-center">
                                        <img t-att-src="'/web/image/res.partner/'+reservation.partner_id.id+'/image_128'" class="img-thumbnail rounded-circle o_pms_pwa_img_rounded_bg" t-att-title="reservation.partner_id.name" t-att-alt="reservation.partner_id.name" width="55" />
                                    </div>
                                    <div class="col-9 ">
                                        <div class="row">
                                            <div class="col-12">
                                                <strong>
                                                    <span class="o_pms_pwa_reservation_name" t-esc="reservation.partner_id.name" />
                                                </strong>
                                            </div>
                                            <div class="col-12" style="margin-top:-0.5rem">
                                                <a t-att-href="'tel:' + reservation.partner_id.mobile">
                                                    <span class="o_pms_pwa_reservation_anchor" t-esc="reservation.partner_id.mobile" />
                                                </a>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="progress mt-2">
                                    <div t-if="reservation.state == 'onboard'" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.checkins_ratio + '%'" t-att-aria-valuenow="reservation.checkins_ratio" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'cancelled' or reservation.state == 'done' or reservation.state == 'no_show' or reservation.state ==  'no_checkout'" class="progress-bar bg-light" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &gt; 75" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and 75 &gt; reservation.ratio_checkin_data &gt; 50" class="progress-bar bg-warning" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &lt; 50" class="progress-bar bg-danger" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-else="" class="progress-bar" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <div t-if="reservation.unread_msg and reservation.unread_msg &gt; 0 and reservation.messages" class="row">
                                    <div class="col-12">
                                        <button class="btn o_pms_pwa_messages collapsed mt-2" aria-controls="#collapseMessages" data-target="#collapseMessages" type="button" data-toggle="collapse" aria-haspopup="true" aria-expanded="false">
                                            <span data-toggle="tooltip" t-att-title="texts.unread_text || _t('mensajes no leidos')" class="badge bg-red mr-2" t-att-data-original-title="texts.unread_text || _t('mensajes no leidos')">
                                                <t t-esc="reservation.unread_msg" />
                                            </span>
                                            <t t-esc="texts.unread_text || _t('mensajes no leidos')" />
                                            <div class="collapse" id="collapseMessages">
                                                <div class="card card-body">
                                                    <span class="mb-2" t-foreach="reservation.messages" t-as="key" t-att-value="key">
                                                        <h4 class="o_pms_pwa_blue">
                                                            <t t-esc="key[0]" />
                                                            <i class="fa fa-check-square-o float-right"></i>
                                                        </h4>
                                                        <p>
                                                            <t t-esc="key[1]" />
                                                        </p>
                                                    </span>
                                                </div>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <!-- Form action needs to be updated with the real action -->
                            <form class="mt-2 o_pms_pwa_reservation_form" target="_self" t-att-action="'/reservation/'+reservation.id" method="post">
                                <div class="form-group form-field mt8">
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <label class="control-label col-12" for="room_type_id">
                                                <t t-esc="texts.room_type_text || _t('Tipo de habitación')" />
                                            </label>
                                            <select data-select="room_types" class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="room_type_id">
                                                <option t-foreach="room_types" t-as="key" t-att-value="key.id" t-att-selected="reservation.room_type_id.id === key.id ? 'selected' : None">
                                                    <t t-esc="key.name" />
                                                </option>
                                            </select>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="control-label col-12" for="pricelist_id">
                                                Tarifa
                                            </label>
                                            <select data-select="allowed_pricelists" class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="pricelist_id">
                                                <option t-foreach="reservation.allowed_pricelists" t-as="key" t-att-value="key.id" t-att-selected="reservation.pricelist_id === key.id ? 'selected' : None">
                                                    <t t-esc="key.name" />
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-6">
                                            <label class="control-label col-12" for="preferred_room_id">
                                                <t t-esc="texts.room_number_text || _t('Nº habitación')" />
                                            </label>
                                            <select data-select="room_numbers" class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="preferred_room_id">
                                                <option t-foreach="room_numbers" t-as="key" t-att-value="key.id" t-att-selected="reservation.preferred_room_id.id === key.id ? 'selected' : None">
                                                    <t t-esc="key.name" />
                                                </option>
                                            </select>
                                        </div>
                                        <div class="col-6">
                                            <!-- Modificar el botón para poner el primary-button que vendrá en controllers -->
                                            <!-- <t t-if="reservation.primary_button">
                                                    <t t-raw="reservation.primary_button"/>
                                                </t>
                                            -->
                                            <div class="row o_pms_pwa_modal_buttons" t-if="reservation.primary_button">
                                                <div class="col-6">
                                                    <t t-raw="reservation.primary_button"/>
                                                </div>
                                                <div class="col-6">
                                                    <span class="dropdown">
                                                        <a role="button" class="btn fa fa-ellipsis-v" data-toggle="dropdown" href="#"/>
                                                        <div class="dropdown-menu" aria-labelledby="dLabel">
                                                            <t t-raw="reservation.secondary_buttons"/>
                                                        </div>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-6">
                                            <label class="control-label col-12" for="adults">
                                                <t t-esc="texts.adults_number_text || _t('Adultos')" />
                                            </label>
                                            <input class="form-control" type="text" name="adults" t-att-value="reservation.adults" />
                                        </div>
                                        <div class="col-6">
                                            <label class="control-label col-12" for="nights">
                                                <t t-esc="texts.nights_number_text || _t('Noches')" />
                                            </label>
                                            <input class="form-control" type="text" name="nights" t-att-value="reservation.nights" disabled="disabled" />
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-12">
                                            <label class="control-label col-12" for="checkin">
                                                Fecha de entrada - Fecha de salida
                                            </label>
                                            <input class="form-control" type="text" name="range_check_date_modal" t-attf-value="{{ reservation.checkin }} - {{ reservation.checkout }}" />
                                            <input type="hidden" name="check_in_date" t-att-value="reservation.checkin" />
                                            <input type="hidden" name="check_out_date" t-att-value="reservation.checkout" />
                                            <span class="o_pms_pwa_calendar_icon">
                                                <!-- <span class="fa fa-calendar"/> -->
                                                <img src="/pms_pwa/static/img/svg/calendario-azul.svg" alt="calendar icon" title="calendar" width="20" />
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-6">
                                            <label class="control-label col-12" for="arrival_hour">
                                                <t t-esc="texts.check_in_time_text || _t('Hora de entrada')" />
                                            </label>
                                            <input class="form-control" type="time" name="arrival_hour" t-att-value="reservation.arrival_hour" />
                                        </div>
                                        <div class="col-6">
                                            <label class="control-label col-12" for="departure_hour">
                                                <t t-esc="texts.check_out_time_text || _t('Hora de salida')" />
                                            </label>
                                            <input class="form-control" type="time" name="departure_hour" t-att-value="reservation.departure_hour" />
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <div class="col-sm-6">
                                            <label class="control-label col-12" for="reservation_type">
                                                <t t-esc="_t('Tipo de reserva')" />
                                            </label>
                                            <select class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="reservation_type">
                                                <option t-foreach="reservation.reservation_types" t-as="key" t-att-value="key.id" t-att-selected="reservation.reservation_type === key.id ? 'selected' : None">
                                                    <t t-esc="key.name" />
                                                </option>
                                            </select>
                                        </div>
                                        <div class="col-sm-6">
                                            <label class="control-label col-12" for="board_service_room_id">
                                                Servicios
                                            </label>
                                            <select data-select="allowed_board_service_room_ids" class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="board_service_room_id">
                                                <option name="board_service_room_id" t-foreach="reservation.allowed_board_service_room_ids" t-as="key" t-att-value="key.id" t-att-selected="reservation.board_service_room_id === key.id ? 'selected' : None">
                                                    <t t-esc="key.name" />
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mt-3">
                                        <!-- <div class="col-sm-6">
                                            <label class="control-label col-12" for="price_total">
                                                <t t-esc="texts.total_text || _t('Total')"/>
                                            </label>
                                            <input class="form-control" type="text" name="price_total" t-att-value="reservation.price_total" />
                                        </div> -->
                                        <div class="col-sm-12 mt-3">
                                            <h4 data-toggle="collapse" data-target="#collapse_price_nights">
                                                <i class="fa fa-pencil-square-o" aria-hidden="false" />
                                                Precio/Noche
                                                <i class="fa fa-angle-down rotate-icon" />
                                            </h4>
                                            <div id="collapse_price_nights" class="collapse" aria-labelledby="headingOne">
                                                <table class="table table-condensed">
                                                    <thead>

                                                        <tr>
                                                            <th class="o_pms_pwa_theme_color">Día</th>
                                                            <th class="o_pms_pwa_theme_color">Precio</th>
                                                            <th class="o_pms_pwa_theme_color">Descuento (%)</th>
                                                        </tr>

                                                    </thead>
                                                    <tbody>
                                                        <t t-foreach="reservation.reservation_line_ids" t-as="i">
                                                            <tr>
                                                                <td>
                                                                    <t t-esc="i_value['date']" t-options='{"widget":"date"}'/>
                                                                </td>
                                                                <td>
                                                                    <input type="number" t-attf-data-main_field="reservation_line_ids" t-attf-data-field_id="{{i}}" name="price" t-att-value="i_value['price']" class="form-control o_pms_pwa_modal_number" />
                                                                </td>
                                                                <td>
                                                                    <input type="number" t-attf-data-main_field="reservation_line_ids" t-attf-data-field_id="{{i}}" name="discount" t-att-value="i_value['discount']" class="form-control o_pms_pwa_modal_number" />
                                                                </td>
                                                            </tr>
                                                        </t>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- <div class="form-group form-field">
                                    <div class="row">
                                        <div class="col-12">
                                            <label
                                                class="control-label col-12"
                                                for="room_price"
                                            >
                                                <t
                                                    t-esc="texts.room_price_text || _t('Precio de habitación')"
                                                />
                                            </label>
                                            <input
                                                class="form-control"
                                                type="text"
                                                name="room_price"
                                                t-att-value="reservation.folio_id.amount_total.value"
                                            />
                                        </div>
                                    </div>
                                </div> -->

                                <div class="form-group form-field o_pms_pwa_group_separation">
                                    <div class="row m-3">

                                        <t t-foreach="reservation.service_ids" t-as="service">
                                            <input type="hidden" t-attf-name="o_pms_pwa_service_line_{{service}}" t-attf-value="{{service}}"/>
                                            <div class="col-12">

                                                <div class="form-check" t-if="service_value.service_line_ids">
                                                    <input class="o_pms_pwa_checkbox" type="checkbox" checked="checked" t-att-data-service_id="service" t-attf-id="defaultCheck{{service}}" data-toggle='collapse' t-attf-data-target='#collapsediv{{service}}' aria-expanded="true" t-attf-aria-controls="collapsediv{{service}}" />
                                                    <label class="o_pms_pwa_checkbox_label" t-attf-for="defaultCheck{{service}}">
                                                        <t t-esc="service_value.product_id" />
                                                    </label>
                                                    <div t-attf-id='collapsediv{{service}}' class='o_pms_pwa_collapse collapse show'>
                                                        <div class="o_pms_pwa_collapse_content mt-3">
                                                            <br />
                                                            <table>
                                                                <thead>
                                                                    <tr>
                                                                        <th class="o_pms_pwa_detail_th">Fecha</th>
                                                                        <th class="o_pms_pwa_detail_th">Cantidad</th>
                                                                        <th class="o_pms_pwa_detail_th">Precio</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <t t-foreach="service_value.service_line_ids" t-as="s">
                                                                        <tr t-attf-class="o_roomdoo_hide_show_service_{{service}}">
                                                                            <td class="o_pms_pwa_detail_td">
                                                                                <span t-esc="s_value.date" t-options='{"widget":"date"}'/>
                                                                            </td>
                                                                            <td class="o_pms_pwa_detail_td o_pms_pwa_td_rb">
                                                                                <div class="o_pms_pwa_rb_box">
                                                                                    <div class="o_pms_pwa_rb">
                                                                                        <div class="o_pms_pwa_rb_tab o_pms_pwa_rb_remove" t-attf-data-reservation-id="{{ reservation.id }}" t-attf-data-id="{{ s }}" t-attf-data-service-id="{{ service }}">
                                                                                            <div class="o_pms_pwa_rb_spot">
                                                                                                <span class="o_pms_pwa_rb_txt">
                                                                                                X
                                                                                            </span>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="o_pms_pwa_rb_tab o_pms_pwa_rb_tab_active">
                                                                                            <div class="o_pms_pwa_rb_spot">
                                                                                                <span t-attf-class="o_pms_pwa_rb_txt o_pms_pwa_rb_value_{{ s }}">
                                                                                                    <t t-esc="s_value.day_qty" />
                                                                                                </span>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="o_pms_pwa_rb_tab o_pms_pwa_rb_edit" data-toggle="modal" data-target="#o_pms_pwa_editModal" t-attf-data-reservation-id="{{ reservation.id }}" t-attf-data-service-id="{{ service }}" t-attf-data-id="{{ s }}">
                                                                                            <div class="o_pms_pwa_rb_spot">
                                                                                                <span class="o_pms_pwa_rb_txt">
                                                                                                    <i class="fa fa-edit"></i>
                                                                                                </span>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </td>
                                                                            <td>
                                                                                <input type="number" t-attf-data-main_field="service_ids" t-attf-data-main_field_id="{{ service }}" data-subservice_name="service_line_ids" t-attf-data-field_id="{{s}}" t-attf-id="price_{{ service }}_{{ s }}" name="price"  t-attf-value="{{ s_value.price_unit }}" class="form-control o_pms_pwa_modal_number" />
                                                                            </td>
                                                                        </tr>

                                                                    </t>
                                                                </tbody>
                                                            </table>
                                                            <br />
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- <div class="form-check mt-2" t-if="service.service_line_ids==''">
                                                    <input class="o_pms_pwa_checkbox" type="checkbox" id="defaultCheck2" checked="checked" />
                                                    <label class="o_pms_pwa_checkbox_label" for="defaultCheck2">
                                                        <t t-esc="service.product_id.name" />
                                                    </label>
                                                </div> -->
                                            </div>
                                            <div class="col-12 mt-2">
                                                <div class="o_roomdoo_hide_show-services-more o_roomdoo_hide_show-more2" t-attf-data-service-id="{{service}}">Ver más</div>
                                            </div>
                                        </t>
                                        <input type="hidden" name="reservation_extras" />
                                        <!-- <div class="form-check mt-2">
                                                <a class="o_pms_pwa_extras" href="#">Más extras</a>
                                            </div> -->
                                    </div>
                                    <div class="row mt-4">
                                        <div class="col-sm-12">
                                            <label class="control-label col-12" for="add_service">
                                                Añadir servicio
                                            </label>
                                            <select class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="add_service">

                                                <option t-foreach="reservation.allowed_service_ids" t-as="key" t-att-value="key_value.id">
                                                    <t t-esc="key_value.name" t-att-data-service_id="key_value.id"/>
                                                </option>

                                            </select>
                                        </div>
                                    </div>
                                    <div class="row mt-4">
                                        <div class="col-12">
                                            <select data-select="allowed_segmentations" multiple="true" data-style="form-control o_pms_pwa_multiselect" class="selectpicker w-100" data-live-search="true" name="segmentation_ids" title="Motivo viaje" />
                                        </div>
                                    </div>
                                </div>

                                <div class="form-group form-field o_pms_pwa_group_separation">

                                    <div class="o_pms_pwa_shadow mt-3">
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="row mx-2">
                                                    <div class="o_pms_pwa_total_title col-12">
                                                        <t t-esc="texts.total_text || _t('Precio total reserva')" />
                                                    </div>
                                                    <div class="o_pms_pwa_total_price col-12">
                                                        <strong t-esc="reservation.price_total" class="price_total"/>
                                                        <span>
                                                            (
                                                            <t t-esc="reservation.price_tax"/>
                                                            iva)
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="row mx-2">
                                                    <div class="o_pms_pwa_total_title col-12">
                                                        <t t-esc="texts.outstading_text || _t('Importe pendiente')" />
                                                    </div>
                                                    <div class="o_pms_pwa_total_price col-12" t-if="reservation.folio_pending_amount">
                                                        <strong t-esc="reservation.folio_pending_amount" class="pending_amount"/>

                                                        <!-- <span>
                                                            (
                                                            <t t-esc="reservation.folio_id.outstanding_vat" />
                                                            € vat)
                                                        </span> -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                </div>

                                <div class="row mt-4" t-if="reservation.folio_internal_comment">
                                    <div class="col-12">
                                        <h4>
                                            <t t-esc="texts.notes_text || _t('Observaciones')" />
                                        </h4>
                                        <div>
                                            <t t-esc="reservation.folio_internal_comment" />
                                        </div>
                                    </div>
                                </div>


                            </form>
                        </div>
                    </div>
                    <!-- modal-content -->
                </div>
                <!-- modal-dialog -->
            </div>
            <!-- modal -->
        </t>
    </t>

    <t t-name="pms_pwa.reservation_checkout_modal">
        <t t-if="reservation">
            <div class="modal o_pms_pwa_right fade o_pms_pwa_reservation_modal" tabindex="-1" role="dialog" aria-labelledby="o_pms_pwa_reservation_modal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header o_pms_pwa_modal_header">
                            <div class="col-12">
                                <div class="row o_pms_pwa_modal_header_pad">
                                    <h4 class="modal-title">
                                        Checkout reserva:
                                        <span t-esc="reservation.id" />
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="modal-body o_pms_pwa_modal_body">
                            <div class="o_pms_pwa_shadow">
                                <div class="row">
                                    <div class="col-3 align-self-center">
                                        <img t-att-src="'/web/image/res.partner/'+reservation.partner_id.id+'/image_128'" class="img-thumbnail rounded-circle o_pms_pwa_img_rounded_bg" t-att-title="reservation.partner_id.name" t-att-alt="reservation.partner_id.name" width="55" />
                                    </div>
                                    <div class="col-9 ">
                                        <div class="row">
                                            <div class="col-12">
                                                <strong>
                                                    <span class="o_pms_pwa_reservation_name" t-esc="reservation.partner_id.name" />
                                                </strong>
                                            </div>
                                            <div class="col-12" style="margin-top:-0.5rem">
                                                <a t-att-href="'tel:' + reservation.partner_id.mobile">
                                                    <span class="o_pms_pwa_reservation_anchor" t-esc="reservation.partner_id.mobile" />
                                                </a>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="progress mt-2">
                                    <div t-if="reservation.state == 'onboard'" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.checkins_ratio + '%'" t-att-aria-valuenow="reservation.checkins_ratio" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'cancelled' or reservation.state == 'done' or reservation.state == 'no_show' or reservation.state ==  'no_checkout'" class="progress-bar bg-light" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &gt; 75" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and 75 &gt; reservation.ratio_checkin_data &gt; 50" class="progress-bar bg-warning" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &lt; 50" class="progress-bar bg-danger" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-else="" class="progress-bar" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="mt-4">
                                        <h5>¿Está seguro de que desea pagar esta reserva? </h5>
                                        <p>
                                            <strong>Nombre:</strong>
                                            <t t-esc="reservation.partner_id.name" />
                                        </p>
                                        <p>
                                            <strong>Noches:</strong>
                                            <t t-esc="reservation.nights" />
                                        </p>
                                        <p>
                                            <strong>Adultos:</strong>
                                            <t t-esc="reservation.adults" />
                                        </p>
                                        <p>
                                            <strong>Importe pendiente:</strong>
                                            <t t-esc="reservation.folio_pending_amount" />
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <button type="button" class="btn btn-block o_pms_pwa_btn_border" data-dismiss="modal" aria-label="Close">
                                        <span>Cerar</span>
                                    </button>
                                </div>
                                <div class="col-6">
                                    <button type="button" t-att-url="'/reservation/' + reservation.id +'/checkout'" class="btn btn-message btn-block o_pms_pwa_button_checkout_confirm" data-dismiss="modal" aria-label="Checkout">
                                        <span>Pagar</span>
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!-- modal-content -->
                </div>
                <!-- modal-dialog -->
            </div>
        </t>
    </t>

    <t t-name="pms_pwa.reservation_cancel_modal">
        <t t-if="reservation">
            <div class="modal o_pms_pwa_right fade o_pms_pwa_reservation_modal" tabindex="-1" role="dialog" aria-labelledby="o_pms_pwa_reservation_modal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header o_pms_pwa_modal_header">
                            <div class="col-12">
                                <div class="row o_pms_pwa_modal_header_pad">
                                    <h4 class="modal-title">
                                        Cancelar reserva:
                                        <span t-esc="reservation.id" />
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="modal-body o_pms_pwa_modal_body">
                            <div class="o_pms_pwa_shadow">
                                <div class="row">
                                    <div class="col-3 align-self-center">
                                        <img t-att-src="'/web/image/res.partner/'+reservation.partner_id.id+'/image_128'" class="img-thumbnail rounded-circle o_pms_pwa_img_rounded_bg" t-att-title="reservation.partner_id.name" t-att-alt="reservation.partner_id.name" width="55" />
                                    </div>
                                    <div class="col-9 ">
                                        <div class="row">
                                            <div class="col-12">
                                                <strong>
                                                    <span class="o_pms_pwa_reservation_name" t-esc="reservation.partner_id.name" />
                                                </strong>
                                            </div>
                                            <div class="col-12" style="margin-top:-0.5rem">
                                                <a t-att-href="'tel:' + reservation.partner_id.mobile">
                                                    <span class="o_pms_pwa_reservation_anchor" t-esc="reservation.partner_id.mobile" />
                                                </a>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="progress mt-2">
                                    <div t-if="reservation.state == 'onboard'" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.checkins_ratio + '%'" t-att-aria-valuenow="reservation.checkins_ratio" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'cancelled' or reservation.state == 'done' or reservation.state == 'no_show' or reservation.state ==  'no_checkout'" class="progress-bar bg-light" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &gt; 75" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and 75 &gt; reservation.ratio_checkin_data &gt; 50" class="progress-bar bg-warning" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &lt; 50" class="progress-bar bg-danger" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-else="" class="progress-bar" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="mt-4">
                                        <h5>¿Estás seguro de que deseas cancelar esta reserva?</h5>
                                        <p>
                                            <strong>Nombre:</strong>
                                            <t t-esc="reservation.partner_id.name" />
                                        </p>
                                        <p>
                                            <strong>Noches:</strong>
                                            <t t-esc="reservation.nights" />
                                        </p>
                                        <p>
                                            <strong>Adultos:</strong>
                                            <t t-esc="reservation.adults" />
                                        </p>
                                        <p>
                                            <strong>Importe pendiente:</strong>
                                            <t t-esc="reservation.folio_pending_amount" />
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <button type="button" class="btn btn-block o_pms_pwa_btn_border" data-dismiss="modal" aria-label="Close">
                                        <span>Cerrar</span>
                                    </button>
                                </div>
                                <div class="col-6">
                                    <button type="button" t-att-url="'/reservation/' + reservation.id +'/cancel'" class="btn btn-message btn-block o_pms_pwa_button_cancel_confirm" data-dismiss="modal" aria-label="Cancel">
                                        <span>Cancelar</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- modal-content -->
                </div>
                <!-- modal-dialog -->
            </div>
        </t>
    </t>

    <t t-name="pms_pwa.reservation_payment_modal">
        <t t-if="reservation">
            <div class="modal o_pms_pwa_right fade o_pms_pwa_reservation_modal" tabindex="-1" role="dialog" aria-labelledby="o_pms_pwa_reservation_modal">
                <div class="modal-dialog" role="document" t-att-payment-data-id="reservation.id">
                    <div class="modal-content">
                        <div class="modal-header o_pms_pwa_modal_header">
                            <div class="col-12">
                                <div class="row o_pms_pwa_modal_header_pad">
                                    <h4 class="modal-title">
                                        Pago de reserva:
                                        <span t-esc="reservation.id" />
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="modal-body o_pms_pwa_modal_body">
                            <div class="o_pms_pwa_shadow">
                                <div class="row">
                                    <div class="col-3 align-self-center">
                                        <img t-att-src="'/web/image/res.partner/'+reservation.partner_id.id+'/image_128'" class="img-thumbnail rounded-circle o_pms_pwa_img_rounded_bg" t-att-title="reservation.partner_id.name" t-att-alt="reservation.partner_id.name" width="55" />
                                    </div>
                                    <div class="col-9 ">
                                        <div class="row">
                                            <div class="col-12">
                                                <strong>
                                                    <span class="o_pms_pwa_reservation_name" t-esc="reservation.partner_id.name" />
                                                </strong>
                                            </div>
                                            <div class="col-12" style="margin-top:-0.5rem">
                                                <a t-att-href="'tel:' + reservation.partner_id.mobile">
                                                    <span class="o_pms_pwa_reservation_anchor" t-esc="reservation.partner_id.mobile" />
                                                </a>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="progress mt-2">
                                    <div t-if="reservation.state == 'onboard'" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.checkins_ratio + '%'" t-att-aria-valuenow="reservation.checkins_ratio" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'cancelled' or reservation.state == 'done' or reservation.state == 'no_show' or reservation.state ==  'no_checkout'" class="progress-bar bg-light" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &gt; 75" class="progress-bar bg-success" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and 75 &gt; reservation.ratio_checkin_data &gt; 50" class="progress-bar bg-warning" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-elif="reservation.state == 'confirm' and reservation.ratio_checkin_data &lt; 50" class="progress-bar bg-danger" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                    <div t-else="" class="progress-bar" role="progressbar" t-att-style="'width:'+ reservation.ratio_checkin_data + '%'" t-att-aria-valuenow="reservation.ratio_checkin_data" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="form-group form-field mt8">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <label class="control-label col-12" for="payment_method">
                                                Método de pago
                                            </label>
                                            <select class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="payment_method">
                                                <option t-foreach="reservation.payment_methods" t-as="key" t-att-value="key.id">
                                                    <t t-esc="key.name" />
                                                </option>
                                            </select>
                                        </div>

                                        <div class="col-sm-12 mt-2">
                                            <label class="control-label col-12" for="amount">
                                                Importe
                                            </label>
                                            <input class="form-control" type="number" min="0" step="any" name="amount" t-att-value="reservation.folio_pending_amount" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <button type="button" class="btn btn-block o_pms_pwa_btn_border" data-dismiss="modal" aria-label="Close">
                                        <span>Cerrar</span>
                                    </button>
                                </div>
                                <div class="col-6">
                                    <button type="button" class="btn btn-message btn-block o_pms_pwa_button_payment_confirm" data-dismiss="modal" aria-label="Pay">
                                        <span>Pagar</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- modal-content -->
                </div>
                <!-- modal-dialog -->
            </div>
        </t>
    </t>

    <t t-name="pms_pwa.reservation_checkin_modal">
        <t t-if="reservation">
            <div class="modal o_pms_pwa_right fade o_pms_pwa_reservation_modal" tabindex="-1" role="dialog" aria-labelledby="o_pms_pwa_reservation_modal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header o_pms_pwa_modal_header">
                            <div class="col-12">
                                <div class="row o_pms_pwa_modal_header_pad">
                                    <h4 class="modal-title">
                                        Checkin reserva:
                                        <span t-esc="reservation.id" />
                                    </h4>
                                </div>
                            </div>
                        </div>
                        <div class="modal-body o_pms_pwa_modal_body">
                            <div class="bs-stepper" t-att-guest-data-id="reservation.id">
                                <div class="bs-stepper-header" role="tablist">
                                    <!-- your steps here -->
                                    <t t-set="step_counter" t-value="1" />
                                    <t t-foreach="reservation.checkin_partner_ids" t-as="partner_id">
                                        <div class="step" t-att-data-target="'#checkin_partner_'+partner_id">
                                            <button type="button" class="step-trigger" role="tab" t-att-aria-controls="'#checkin_partner_'+partner_id" t-att-id="'checkin_partner_'+partner_id+'-trigger'">
                                                <span class="bs-stepper-circle">
                                                    <t t-esc="step_counter" />
                                                </span>
                                            </button>
                                        </div>
                                        <div class="line"></div>
                                        <t t-set="step_counter" t-value="step_counter + 1" />
                                    </t>
                                </div>
                                <div class="bs-stepper-content">
                                    <!-- your steps content here -->
                                    <!-- <t t-set="step_counter" t-value="1" /> -->
                                    <t t-foreach="reservation.checkin_partner_ids" t-as="partner">
                                        <div t-att-id="'checkin_partner_'+partner" class="content" role="tabpanel" t-att-aria-labelledby="'checkin_partner_'+partner+'-trigger'">
                                            <div class="form-group form-field mt8">
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <label class="control-label col-12" for="firstname">
                                                            Nombre
                                                        </label>
                                                        <input class="form-control" type="text" name="firstname" t-att-value="partner.firstname ? partner.firstname : ''" />
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="lastname">
                                                            Primer apellido
                                                        </label>
                                                        <input class="form-control" type="text" name="lastname" t-att-value="partner.lastname ? partner.lastname : ''" />
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="lastname2">
                                                            Segundo apellido
                                                        </label>
                                                        <input class="form-control" type="text" name="lastname2" t-att-value="partner.lastname2 ? partner.lastname2 : ''" />
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="birthdate_date">
                                                            Fecha de nacimiento
                                                        </label>
                                                        <input class="form-control o_pms_pwa_daterangepicker" type="date" name="birthdate_date" t-att-value="partner.birthdate_date ? partner.birthdate_date : ''" />
                                                        <span class="o_pms_pwa_calendar_icon">
                                                            <!-- <span class="fa fa-calendar" /> -->
                                                            <img src="/pms_pwa/static/img/svg/calendario-azul.svg" alt="calendar icon" title="calendar" width="20" />
                                                        </span>
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="document_number">
                                                            NIF/CIF
                                                        </label>
                                                        <input class="form-control" type="text" name="document_number" t-att-value="partner.document_number ? partner.document_number : ''" />
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="document_type">
                                                            Tipo de documento
                                                        </label>
                                                        <select class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="document_type">
                                                            <option value="D" t-att-selected="partner.document_type == D ? 'selected' : None">
                                                                DNI
                                                            </option>
                                                            <option value="P" t-att-selected="partner.document_type == P ? 'selected' : None">
                                                                Pasaporte
                                                            </option>
                                                            <option value="C" t-att-selected="partner.document_type == C ? 'selected' : None">
                                                                Carnet de conducir
                                                            </option>
                                                            <option value="I" t-att-selected="partner.document_type == I ? 'selected' : None">
                                                                Documento de identificación
                                                            </option>
                                                            <option value="N" t-att-selected="partner.document_type == N ? 'selected' : None">
                                                                Permiso de residencia española
                                                            </option>
                                                            <option value="X" t-att-selected="partner.document_type == X ? 'selected' : None">
                                                                Permiso de residencia europea
                                                            </option>
                                                        </select>
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="document_expedition_date">
                                                            Fecha de caducidad del documento
                                                        </label>
                                                        <input class="form-control o_pms_pwa_daterangepicker" type="date" name="document_expedition_date" t-att-value="partner.document_expedition_date ? partner.document_expedition_date : ''" />
                                                        <span class="o_pms_pwa_calendar_icon">
                                                            <!-- <span class="fa fa-calendar" /> -->
                                                            <img src="/pms_pwa/static/img/svg/calendario-azul.svg" alt="calendar icon" title="calendar" width="20" />
                                                        </span>
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="gender">
                                                            Género
                                                        </label>
                                                        <select class="form-control o_website_form_input o_domain_leaf_operator_select o_input" name="gender">
                                                            <option value="male" t-att-selected="partner.gender == 'male' ? 'selected' : None">
                                                                Hombre
                                                            </option>
                                                            <option value="female" t-att-selected="partner.gender == 'female' ? 'selected' : None">
                                                                Mujer
                                                            </option>
                                                            <option name="gender" value="other" t-att-selected="partner.gender == 'other' ? 'selected' : None">
                                                                Otro
                                                            </option>
                                                        </select>
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="mobile">
                                                            Móvil
                                                        </label>
                                                        <input class="form-control" type="tel" name="mobile" t-att-value="partner.mobile ? partner.mobile : ''" />
                                                    </div>

                                                    <div class="col-sm-12 mt-2">
                                                        <label class="control-label col-12" for="email">
                                                            Email
                                                        </label>
                                                        <input class="form-control" type="email" name="email" t-att-value="partner.email ? partner.email : ''" />

                                                        <input class="form-control" type="hidden" name="pms_property_id" t-att-value="reservation.pms_property_id" />
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <t t-set="step_counter" t-value="step_counter + 1" />
                                    </t>
                                </div>
                            </div>
                            <button type="button" class="btn btn-block o_pms_pwa_btn_border o_pms_pwa_30w float-right" data-dismiss="modal" aria-label="Close">
                                <span>Cerrar</span>
                            </button>
                            <button type="button" class="btn btn-message btn-block o_pms_pwa_button_checkin_confirm o_pms_pwa_30w" data-dismiss="modal" aria-label="Checkin">
                                <span>Checkin</span>
                            </button>
                        </div>
                    </div>
                    <!-- modal-content -->
                </div>
                <!-- modal-dialog -->
            </div>
        </t>
    </t>

    <t t-name="pms_pwa.reservation_alerts">
        <t t-if="alert">
            <div t-attf-class="toast show {{ alert['type'] }}" data-autohide="false">
                <div class="toast-header">
                    <strong class="mr-auto">
                        <i class="fa fa-bell"></i>
                    </strong>
                    <button type="button" class="ml-2 mb-1 o_pms_pwa_toast-close close" data-dismiss="toast">
                        <span>x</span>
                    </button>
                </div>
                <div class="toast-body">
                    <t t-esc="alert['message']" />
                </div>
            </div>
        </t>
    </t>


</templates>
